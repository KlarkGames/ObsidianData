#Data_Science 

Решающее дерево есть алгоритм, позволяющий построить произвольное дерево по заданным признакам.

Основная идея заключается в том, что на каждой просматриваемой вершине дерева подбирается такой признак, который бы лучшим способом разделял элементы первого класса от нулевого.

![[Pasted image 20220831164249.png]]

Более формальным критерием выбора функции разбиения является следующее правило:
$$\frac{L}{Q}H(p_{L})+ \frac{R}{Q}H(p_{R}) \to \text{min}$$
Где $Q$ - количество элементов на входе в вершину (Для красной вершины это 20), $L$ - количество элементов ушедших по левому ребру (13), $R$ - ушедших по правому (7).
Параметр $p_{Q}$ определяется так: $p_{Q} = \frac{Y_{true}}{Q}$. Таким образом в данном случае $p_{L} = \frac{8}{13};\quad p_{R} = \frac{1}{7}$. 

![[Pasted image 20220831165103.png]]

Чаще всего функцию $H(p_{Q})$ определяют одним из двух вариантов:
- Энтропией:
  $H(q) = -q\log q-(1-q)\log(1-q)$
  - Индексом Джини:
  $H(q)=4q(1-q)$

![[Pasted image 20220831165504.png]]
Определив решающее правило (Например $x_{n} < K$), находим нужный $K$ путем [[Минимизация функций одной переменной|минимизации функции одной переменной]].

